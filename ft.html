<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Featured Recipes</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Sidebar -->
  <div id="sidebar" class="sidebar">
    <a href="index.html">Home</a>
    <a href="featured.html">Featured Recipes</a>
    <a href="devs.html">Devs</a>
    <a href="recipes.html">Search Recipes</a>
  </div>

  <!-- Navbar -->
  <div class="navbar">
    <span id="hamburger" onclick="toggleSidebar()">☰</span>
    <h1>Featured Recipes</h1>
    <button id="dark-mode-toggle">🌙</button>
  </div>

  <main>
    <section>
      <h2>🌾 Gluten Free Recipes</h2>
      <div id="gluten-free" class="recipe-grid"></div>
    </section>

    <section>
      <h2>🥜 Nut Free Recipes</h2>
      <div id="nut-free" class="recipe-grid"></div>
    </section>

    <section>
      <h2>🌱 Vegan Recipes</h2>
      <div id="vegan" class="recipe-grid"></div>
    </section>
  </main>

  <script>
    const apiKey = "2c5260fbaaab48548f813524144c9082";

    function toggleSidebar() {
      const sidebar = document.getElementById("sidebar");
      const hamburger = document.getElementById("hamburger");
      sidebar.classList.toggle("open");
      hamburger.classList.toggle("active");
    }

    // Dark mode persistence
    const darkModeToggle = document.getElementById("dark-mode-toggle");
    window.addEventListener("DOMContentLoaded", () => {
      const savedTheme = localStorage.getItem("theme");
      if (savedTheme === "dark") {
        document.body.classList.add("dark");
        darkModeToggle.textContent = "☀️";
      } else {
        document.body.classList.remove("dark");
        darkModeToggle.textContent = "🌙";
      }
    });
    darkModeToggle.addEventListener("click", () => {
      document.body.classList.toggle("dark");
      const isDark = document.body.classList.contains("dark");
      darkModeToggle.textContent = isDark ? "☀️" : "🌙";
      localStorage.setItem("theme", isDark ? "dark" : "light");
    });

    // Fetch recipes
    async function fetchFeaturedRecipes(type, params, targetId) {
      const target = document.getElementById(targetId);
      target.innerHTML = "<p>Loading...</p>";

      try {
        const response = await fetch(
          `https://api.spoonacular.com/recipes/complexSearch?number=3&${params}&apiKey=${apiKey}`
        );
        const data = await response.json();

        if (!response.ok || !data.results || data.results.length === 0) {
          target.innerHTML = `<p>No ${type} recipes found.</p>`;
          return;
        }

        target.innerHTML = data.results.map(recipe => `
          <div class="recipe-card">
            <img src="${recipe.image}" alt="${recipe.title}">
            <div class="recipe-content">
              <h3>${recipe.title}</h3>
              <a href="https://spoonacular.com/recipes/${recipe.title.replace(/ /g, "-")}-${recipe.id}" 
                 target="_blank" 
                 class="view-recipe-btn">View Recipe</a>
            </div>
          </div>
        `).join("");
      } catch {
        target.innerHTML = `<p>Error loading ${type} recipes.</p>`;
      }
    }

    // Load featured recipes
    fetchFeaturedRecipes("Gluten Free", "diet=gluten free", "gluten-free");
    fetchFeaturedRecipes("Nut Free", "intolerances=peanut,tree nut", "nut-free");
    fetchFeaturedRecipes("Vegan", "diet=vegan", "vegan");
  </script>
</body>
</html>
