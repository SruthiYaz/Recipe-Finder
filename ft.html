<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FEATURED RECIPES</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Hamburger for sidebar -->
  <div id="hamburger" onclick="toggleSidebar()">â˜°</div>

  <!-- Sidebar -->
  <div id="sidebar">
    <a href="index.html">Home</a>
    <a href="dev.html">Developers</a>
    <a href="featured.html">Featured</a>
  </div>

  <!-- Dark mode toggle -->
  <button id="dark-mode-toggle">ðŸŒ™</button>

  <h1>Featured Recipes</h1>
  <p style="text-align:center; font-size:1.2rem; margin-bottom:30px;">
    Don't know what to eat today? Go through our featured assortments of gluten-free, nut-free and vegan recipes!
  </p>

  <style>
    body { font-family: "Poppins", sans-serif; background-color: #ffe5d4; margin:0; padding:20px; }
    h1 { text-align:center; color:#ff6f61; }
    .carousel-container { margin:40px auto; max-width:900px; background:#fff5ef; padding:20px; border-radius:20px; box-shadow:0 6px 12px rgba(0,0,0,0.1); }
    h2 { color:#e68a7e; margin-bottom:15px; }
    .carousel { display:flex; overflow-x:auto; scroll-snap-type:x mandatory; gap:20px; padding-bottom:10px; }
    .recipe { min-width:250px; max-width:250px; height:360px; flex:0 0 auto; background:white; border-radius:15px; box-shadow:0 4px 8px rgba(0,0,0,0.1); scroll-snap-align:center; padding:15px; text-align:center; display:flex; flex-direction:column; }
    .recipe img { width:100%; height:160px; object-fit:cover; border-radius:12px; margin-bottom:10px; }
    .recipe h3 { margin:5px 0; font-size:18px; color:#5a3e36; }
    .recipe p { font-size:14px; color:#666; margin-top:5px; flex-grow:1; overflow:hidden; text-overflow:ellipsis; }
  </style>

  <div class="carousel-container">
    <h2>ðŸ¥— Gluten-Free Recipes</h2>
    <div class="carousel" id="gluten-free-carousel"></div>
  </div>

  <div class="carousel-container">
    <h2>ðŸ¥œ Nut-Free Recipes</h2>
    <div class="carousel" id="nut-free-carousel"></div>
  </div>

  <div class="carousel-container">
    <h2>ðŸŒ± Vegan Recipes</h2>
    <div class="carousel" id="vegan-carousel"></div>
  </div>

<script>
const apiKey = "YOUR_REAL_KEY_HERE"; // ðŸ”‘ put your actual Spoonacular key
const today = new Date().toISOString().split("T")[0];

// fallback recipes
const fallback = {
  gluten: [
    { title: "Gluten-Free Pancakes", image:"https://i.imgur.com/s5wL3wM.jpeg", summary:"Fluffy gluten-free pancakes for breakfast." },
    { title: "Gluten-Free Pizza", image:"https://i.imgur.com/gz7b9p0.jpeg", summary:"Tasty pizza without gluten." },
    { title: "Gluten-Free Pasta", image:"https://i.imgur.com/hz2n2Un.jpeg", summary:"Light pasta without gluten." }
  ],
  nut: [
    { title: "Nut-Free Cookies", image:"https://i.imgur.com/fpSkF7M.jpeg", summary:"Delicious cookies safe for nut allergies." },
    { title: "Nut-Free Brownies", image:"https://i.imgur.com/WkO7d3P.jpeg", summary:"Rich chocolate brownies safe for nut allergies." },
    { title: "Nut-Free Muffins", image:"https://i.imgur.com/xnbqFy1.jpeg", summary:"Soft muffins made nut-free." }
  ],
  vegan: [
    { title: "Vegan Salad", image:"https://i.imgur.com/RXIfael.jpeg", summary:"Fresh vegetables and greens." },
    { title: "Vegan Stir-Fry", image:"https://i.imgur.com/3b2jGeU.jpeg", summary:"Quick and healthy vegan stir-fry." },
    { title: "Vegan Smoothie", image:"https://i.imgur.com/xUQ1Tcv.jpeg", summary:"Fruity smoothie packed with nutrients." }
  ]
};

// seeded random
function seededRandom(seed) {
  let x = Math.sin(seed) * 10000;
  return x - Math.floor(x);
}
function pickDailyRandom(arr, count, seed) {
  let result = [];
  let indices = [...arr.keys()];
  for (let i=0; i<count && indices.length>0; i++){
    let idx = Math.floor(seededRandom(seed+i)*indices.length);
    result.push(arr[indices[idx]]);
    indices.splice(idx,1);
  }
  return result;
}

// render recipes
function renderRecipes(containerId, recipes) {
  const container = document.getElementById(containerId);
  container.innerHTML = recipes.map(r => `
    <div class="recipe">
      <img src="${r.image}" alt="${r.title}">
      <h3>${r.title}</h3>
      <p>${r.summary}</p>
    </div>
  `).join("");
}

// try API, fallback if fails
async function fetchRecipes(query, filters, fallbackList, elementId, seed) {
  const container = document.getElementById(elementId);
  container.innerHTML = "<p>Loading...</p>";

  try {
    const url = `https://api.spoonacular.com/recipes/complexSearch?query=${query}&number=10&addRecipeInformation=true&${filters}&apiKey=${apiKey}`;
    const res = await fetch(url);
    if (!res.ok) throw new Error("API error");
    const data = await res.json();

    if (!data.results || data.results.length === 0) throw new Error("No API results");

    const selected = pickDailyRandom(data.results, 3, seed);
    renderRecipes(elementId, selected.map(r => ({
      title: r.title,
      image: r.image,
      summary: r.summary ? r.summary.replace(/<[^>]*>?/gm,'').substring(0,100)+"..." : "Delicious recipe!"
    })));
  } catch (e) {
    console.warn("API failed, using fallback:", e);
    const selected = pickDailyRandom(fallbackList, 3, seed);
    renderRecipes(elementId, selected);
  }
}

// load sections
fetchRecipes("gluten", "intolerances=gluten", fallback.gluten, "gluten-free-carousel", today.length);
fetchRecipes("nut", "intolerances=peanut,tree nut", fallback.nut, "nut-free-carousel", today.length*2);
fetchRecipes("vegan", "diet=vegan", fallback.vegan, "vegan-carousel", today.length*3);
</script>
</body>
</html>
