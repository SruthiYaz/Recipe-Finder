<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Featured Recipes</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Hamburger for sidebar -->
  <div id="hamburger" onclick="toggleSidebar()">â˜°</div>

  <!-- Sidebar -->
  <div id="sidebar">
    <a href="index.html">Home</a>
    <a href="dev.html">Developers</a>
    <a href="featured.html">Featured</a>
  </div>

  <!-- Dark mode toggle -->
  <button id="dark-mode-toggle">ðŸŒ™</button>

  <h1>Featured Recipes</h1>
  <p style="text-align:center; font-size:1.2rem; margin-bottom:30px;">
    Don't know what to eat today? Go through our featured assortments of gluten-free, nut-free and vegan recipes!
  </p>

  <style>
    body { font-family: "Poppins", sans-serif; background-color: #ffe5d4; margin:0; padding:20px; }
    h1 { text-align:center; color:#ff6f61; }
    .carousel-container { margin:40px auto; max-width:900px; background:#fff5ef; padding:20px; border-radius:20px; box-shadow:0 6px 12px rgba(0,0,0,0.1); }
    h2 { color:#e68a7e; margin-bottom:15px; }
    .carousel { display:flex; overflow-x:auto; scroll-snap-type:x mandatory; gap:20px; padding-bottom:10px; }
    .recipe { min-width:250px; max-width:250px; height:360px; flex:0 0 auto; background:white; border-radius:15px; box-shadow:0 4px 8px rgba(0,0,0,0.1); scroll-snap-align:center; padding:15px; text-align:center; display:flex; flex-direction:column; }
    .recipe img { width:100%; height:160px; object-fit:cover; border-radius:12px; margin-bottom:10px; }
    .recipe h3 { margin:5px 0; font-size:18px; color:#5a3e36; }
    .recipe p { font-size:14px; color:#666; margin-top:5px; flex-grow:1; overflow:hidden; text-overflow:ellipsis; }
  </style>
</head>
<body>

<div class="carousel-container">
  <h2>ðŸ¥— Gluten-Free Recipes</h2>
  <div class="carousel" id="gluten-free-carousel"></div>
</div>

<div class="carousel-container">
  <h2>ðŸ¥œ Nut-Free Recipes</h2>
  <div class="carousel" id="nut-free-carousel"></div>
</div>

<div class="carousel-container">
  <h2>ðŸŒ± Vegan Recipes</h2>
  <div class="carousel" id="vegan-carousel"></div>
</div>

<script>
const apiKey = "YOUR_SPOONACULAR_API_KEY"; // replace with your key
const today = new Date().toISOString().split("T")[0];

// seeded random
function seededRandom(seed) {
  let x = Math.sin(seed) * 10000;
  return x - Math.floor(x);
}

function pickDailyRandom(arr, count, seed) {
  let result = [];
  let indices = [...arr.keys()];
  for (let i = 0; i < count && indices.length > 0; i++) {
    let idx = Math.floor(seededRandom(seed + i) * indices.length);
    result.push(arr[indices[idx]]);
    indices.splice(idx, 1);
  }
  return result;
}

// fallback recipes
const fallbackRecipes = [
  { title: "Gluten-Free Pancakes", image:"https://d29fhpw069ctt2.cloudfront.net/clipart/101307/preview/iammisc_Dinner_Plate_with_Spoon_and_Fork_preview_6a8b.png", summary:"Fluffy gluten-free pancakes for breakfast." },
  { title: "Nut-Free Cookies", image:"https://d29fhpw069ctt2.cloudfront.net/clipart/101307/preview/iammisc_Dinner_Plate_with_Spoon_and_Fork_preview_6a8b.png", summary:"Delicious cookies safe for nut allergies." },
  { title: "Vegan Salad", image:"https://d29fhpw069ctt2.cloudfront.net/clipart/101307/preview/iammisc_Dinner_Plate_with_Spoon_and_Fork_preview_6a8b.png", summary:"Fresh vegetables and greens." },
  { title: "Vegan Stir-Fry", image:"https://d29fhpw069ctt2.cloudfront.net/clipart/101307/preview/iammisc_Dinner_Plate_with_Spoon_and_Fork_preview_6a8b.png", summary:"Quick and healthy vegan stir-fry." },
  { title: "Gluten-Free Pizza", image:"https://d29fhpw069ctt2.cloudfront.net/clipart/101307/preview/iammisc_Dinner_Plate_with_Spoon_and_Fork_preview_6a8b.png", summary:"Tasty pizza without gluten." },
  { title: "Nut-Free Brownies", image:"https://d29fhpw069ctt2.cloudfront.net/clipart/101307/preview/iammisc_Dinner_Plate_with_Spoon_and_Fork_preview_6a8b.png", summary:"Rich chocolate brownies safe for nut allergies." }
];

async function fetchRecipes(query, filters, elementId, seed) {
  const container = document.getElementById(elementId);
  container.innerHTML = "<p>Loading...</p>";

  try {
    const url = `https://api.spoonacular.com/recipes/complexSearch?query=${query}&number=15&addRecipeInformation=true&${filters}&apiKey=${apiKey}`;
    const res = await fetch(url);
    const data = await res.json();

    let recipes = (data.results && data.results.length > 0) ? data.results : fallbackRecipes.filter(r => r.title.toLowerCase().includes(query.split(" ")[0]));

    const selected = pickDailyRandom(recipes, 3, seed);

    container.innerHTML = selected.map(r => `
      <div class="recipe">
        <img src="${r.image}" alt="${r.title}">
        <h3>${r.title}</h3>
        <p>${r.summary ? r.summary.replace(/<[^>]*>?/gm,'').substring(0,100) + "..." : "Delicious recipe!"}</p>
      </div>
    `).join("");
  } catch (e) {
    console.error(e);
    container.innerHTML = "<p>Error fetching recipes.</p>";
  }
}

// call fetches
fetchRecipes("gluten", "intolerances=gluten", "gluten-free-carousel", today + "gf");
fetchRecipes("nut", "intolerances=peanut,tree nut", "nut-free-carousel", today + "nf");
fetchRecipes("vegan", "diet=vegan", "vegan-carousel", today + "v");
</script>

